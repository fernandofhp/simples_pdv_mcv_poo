-- CREATE DATABASE PEDIDOSVENDAS CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE CLIENTES (
  CODIGO int(11) AUTO_INCREMENT NOT NULL,
  NOME varchar(50) DEFAULT NULL,
  CIDADE varchar(50) DEFAULT NULL,
  UF char(2) DEFAULT NULL,
  PRIMARY KEY(CODIGO)
) 
ENGINE=InnoDB 
DEFAULT CHARSET=utf8 COLLATE utf8_general_ci;

CREATE TABLE PRODUTOS (
  CODIGO int(11) AUTO_INCREMENT NOT NULL,
  DESCRICAO varchar(50) DEFAULT NULL,
  PRECOVENDA decimal(15,2) DEFAULT '0.00',
  PRIMARY KEY(CODIGO)
) 
ENGINE=InnoDB 
DEFAULT CHARSET=utf8 COLLATE utf8_general_ci;

CREATE TABLE PEDIDOS (
  NUMERO int(11) AUTO_INCREMENT NOT NULL,
  DATAEMISSAO datetime DEFAULT CURRENT_TIMESTAMP,
  CODIGOCLIENTE int(11) DEFAULT NULL,
  VALORTOTAL decimal(15,2) DEFAULT '0.00',
  PRIMARY KEY (NUMERO),
  FOREIGN KEY (CODIGOCLIENTE) REFERENCES CLIENTES(CODIGO)
    ON DELETE CASCADE
    ON UPDATE CASCADE
) 
ENGINE=InnoDB 
DEFAULT CHARSET=utf8 COLLATE utf8_general_ci;

CREATE TABLE  ITENS (
  NUMEROITEM int(11) AUTO_INCREMENT NOT NULL,
  NUMEROPEDIDO int(11) NOT NULL,  
  CODIGOPRODUTO int(11) NOT NULL,
  QUANTIDADE decimal(15,2) DEFAULT '1.00',
  VALORUNITARIO decimal(15,2) DEFAULT '0.00',
  VALORTOTALITEM decimal(15,2) DEFAULT '0.00',
  PRIMARY KEY (NUMEROITEM),
  FOREIGN KEY (NUMEROPEDIDO) REFERENCES PEDIDOS(NUMERO)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  FOREIGN KEY (CODIGOPRODUTO) REFERENCES PRODUTOS(CODIGO)
    ON DELETE CASCADE
    ON UPDATE CASCADE
) 
ENGINE=InnoDB 
DEFAULT CHARSET=utf8 COLLATE utf8_general_ci;

ALTER TABLE PEDIDOS ADD COLUMN GRAVADO INT(1) DEFAULT '0';

